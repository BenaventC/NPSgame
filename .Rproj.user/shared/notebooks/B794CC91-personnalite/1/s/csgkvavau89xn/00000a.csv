"0",""
"0","# Create a dfm per group"
"0","dfm <-toks2 %>%"
"0","    tokens_group(groups = NPS) %>% "
"0","  dfm()"
"0",""
"0",""
"0","# Calculate keyness and determine ""Promoteurs"" as target group againts all other categories"
"0","result_keyness <- textstat_keyness(dfm, target = ""Promoteurs"")"
"0",""
"0","# Plot estimated word keyness"
"0","g1<-textplot_keyness(result_keyness,   n = 30L, labelsize = 3,   show_legend = FALSE, "
"0","                     show_reference = FALSE,   color = c(""Darkgreen"", ""gray""))+"
"0","  xlim(-20,80) + "
"0","  labs(x=NULL)"
"0",""
"0",""
"0","result_keyness <- textstat_keyness(dfm, target = ""Détracteurs"" )"
"0","g2<-textplot_keyness(result_keyness,   n = 30L, labelsize = 3,   show_legend = FALSE,   "
"0","                     show_reference = FALSE,   color = c(""firebrick"", ""gray""))+"
"0","  xlim(0,80)+ "
"0","  labs(x=NULL)"
"0",""
"0",""
"0","result_keyness <- textstat_keyness(dfm, target = ""Passifs"")"
"0","g3<-textplot_keyness(result_keyness,   n = 30L, labelsize = 3,   show_legend = FALSE,   show_reference = FALSE,    color = c(""gold2"", ""gray""))+xlim(0,80)+ labs(x=NULL)"
"0",""
"0",""
"0",""
"0","p<- plot_grid(g2, g3 ,g1,  labels = c('Détracteurs', 'Passifs', 'Promoteurs'), label_size = 12, ncol=3)"
"0","title <- ggdraw() + draw_label(""NPS : Les raisons qui conduisent à la recommandation (keyness)"", fontface='bold')"
"0","note <- ggdraw()+ draw_text(""Les valeurs représentent le keyness des termes.\nIl mesure leur caractère distinctif par une statistique du chi²"", size=8,x = 0.5, y = 0.5)"
"0",""
"0",""
"0","plot_grid(title, p,note, ncol=1, rel_heights=c(0.1, 1)) # rel_heights values control title margins"
